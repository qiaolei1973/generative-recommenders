# ğŸ¯ å¿«é€Ÿå‚è€ƒå¡ç‰‡

## æ ¸å¿ƒç®—æ³•é€ŸæŸ¥è¡¨

### 1ï¸âƒ£ HSTU æ¶æ„
```
è¾“å…¥åºåˆ— â†’ Embedding â†’ STUÃ—N â†’ Output
         (å‘é‡åŒ–)   (å¤šå±‚è½¬æ¢) (é¢„æµ‹)
```

### 2ï¸âƒ£ STU Layer ç»„ä»¶
```
LayerNorm â†’ Multi-Head Attention â†’ FFN â†’ Output
(å½’ä¸€åŒ–)    (æ³¨æ„åŠ›æœºåˆ¶)         (å‰é¦ˆ)  (æ®‹å·®)
```

### 3ï¸âƒ£ æ³¨æ„åŠ›å…¬å¼
```
Attention(Q,K,V) = softmax(QK^T/âˆšd_k) Ã— V
```

### 4ï¸âƒ£ æ€§èƒ½å¯¹æ¯”
| æ¨¡å‹ | HR@10 | æå‡ | é€Ÿåº¦ |
|------|-------|------|------|
| SASRec | 0.2853 | - | 1x |
| HSTU | 0.3097 | +8.6% | 10-1000x |

### 5ï¸âƒ£ å…³é”®å‚æ•°
```python
num_blocks = 2          # STU å±‚æ•°
num_heads = 1           # æ³¨æ„åŠ›å¤´æ•°
embedding_dim = 50      # å‘é‡ç»´åº¦
num_negatives = 128     # è´Ÿæ ·æœ¬æ•°
temperature = 0.05      # æ¸©åº¦å‚æ•°
```

### 6ï¸âƒ£ è®­ç»ƒå‘½ä»¤
```bash
# è®­ç»ƒ
python3 main.py \
  --gin_config_file=configs/ml-1m/hstu-sampled-softmax-n128-final.gin

# ç›‘æ§
tensorboard --logdir exps/ml-1m-l200/
```

### 7ï¸âƒ£ æ•°æ®æ ¼å¼
```
user_id, sequence_item_ids, sequence_ratings, sequence_timestamps
2424, "1721,1210,1641", "4,4,2", "974231993,974232016"
```

### 8ï¸âƒ£ æ ¸å¿ƒæ–‡ä»¶
```
modules/
â”œâ”€â”€ hstu_transducer.py  # HSTU ä¸»æ¨¡å—
â”œâ”€â”€ stu.py              # STU å±‚å®ç°
â””â”€â”€ preprocessors.py    # æ•°æ®é¢„å¤„ç†

ops/
â”œâ”€â”€ hstu_attention.py   # æ³¨æ„åŠ›æœºåˆ¶
â”œâ”€â”€ jagged_tensors.py   # Jagged Tensor
â””â”€â”€ triton/             # æ€§èƒ½ä¼˜åŒ–å†…æ ¸
```

### 9ï¸âƒ£ å¸¸ç”¨æ“ä½œ
```python
# åŠ è½½æ•°æ®
dataset = get_reco_dataset("ml-1m", max_seq_len=200)

# åˆ›å»ºæ¨¡å‹
model = hstu_encoder(num_blocks=2, num_heads=1)

# è®­ç»ƒ
loss = sampled_softmax_loss(predictions, targets)
```

### ğŸ”Ÿ ä¼˜åŒ–æŠ€å·§
- âœ… ä½¿ç”¨ BF16 æ··åˆç²¾åº¦
- âœ… å¯ç”¨é‡è®¡ç®—èŠ‚çœæ˜¾å­˜
- âœ… ä½¿ç”¨ Jagged Tensors
- âœ… è°ƒæ•´ batch_size
- âœ… ä½¿ç”¨ TF32 åŠ é€Ÿ

---

## ğŸ“ å­¦ä¹ æ£€æŸ¥æ¸…å•

### åŸºç¡€æ¦‚å¿µ
- [ ] ç†è§£æ¨èç³»ç»ŸåŸºæœ¬åŸç†
- [ ] æŒæ¡ Transformer æ¶æ„
- [ ] äº†è§£åºåˆ—å»ºæ¨¡é—®é¢˜
- [ ] ç†Ÿæ‚‰ PyTorch åŸºç¡€

### æ ¸å¿ƒç®—æ³•
- [ ] ç†è§£ HSTU æ¶æ„
- [ ] æŒæ¡æ³¨æ„åŠ›æœºåˆ¶
- [ ] äº†è§£ Sampled Softmax
- [ ] ç†è§£ Jagged Tensors

### å®è·µèƒ½åŠ›
- [ ] æˆåŠŸä¸‹è½½æ•°æ®é›†
- [ ] è¿è¡Œè®­ç»ƒè„šæœ¬
- [ ] ç†è§£é…ç½®æ–‡ä»¶
- [ ] è°ƒæ•´è¶…å‚æ•°
- [ ] åˆ†æå®éªŒç»“æœ

### è¿›é˜¶æŠ€èƒ½
- [ ] é˜…è¯» HSTU è®ºæ–‡
- [ ] ç†è§£æ€§èƒ½ä¼˜åŒ–
- [ ] ä¿®æ”¹æ¨¡å‹æ¶æ„
- [ ] åº”ç”¨åˆ°æ–°æ•°æ®é›†

---

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: CUDA Out of Memory
```bash
# è§£å†³æ–¹æ¡ˆ
1. å‡å° batch_size
2. å¯ç”¨é‡è®¡ç®—: recompute_normed_x=True
3. å‡å°æ¨¡å‹: num_blocks=1
4. ä½¿ç”¨æ¢¯åº¦ç´¯ç§¯
```

### é—®é¢˜ 2: è®­ç»ƒé€Ÿåº¦æ…¢
```bash
# è§£å†³æ–¹æ¡ˆ
1. å¯ç”¨ TF32: enable_tf32=True
2. ä½¿ç”¨ Triton å†…æ ¸
3. å¢å¤§ batch_size
4. æ£€æŸ¥æ•°æ®åŠ è½½
```

### é—®é¢˜ 3: æ€§èƒ½ä¸å¥½
```bash
# è§£å†³æ–¹æ¡ˆ
1. å¢åŠ è®­ç»ƒè½®æ•°
2. è°ƒæ•´å­¦ä¹ ç‡
3. å¢åŠ æ¨¡å‹å®¹é‡
4. ä½¿ç”¨æ›´å¤šè´Ÿæ ·æœ¬
```

---

## ğŸ“Š å®éªŒè®°å½•æ¨¡æ¿

```
å®éªŒæ—¥æœŸ: 2026-01-12
æ•°æ®é›†: MovieLens-1M
é…ç½®: hstu-sampled-softmax-n128

è¶…å‚æ•°:
- num_blocks: 2
- num_heads: 1
- embedding_dim: 50
- learning_rate: 1e-3
- num_negatives: 128

ç»“æœ:
- HR@10: 0.3097
- NDCG@10: 0.1720
- è®­ç»ƒæ—¶é—´: 2å°æ—¶
- GPU: RTX 3090

ç¬”è®°:
- å¢åŠ  num_blocks åˆ° 3 å¯èƒ½æå‡æ€§èƒ½
- è€ƒè™‘å°è¯•æ›´å¤§çš„ embedding_dim
```

---

å¿«é€Ÿä¸Šæ‰‹ï¼Œç¥ä½ æˆåŠŸï¼ğŸš€

